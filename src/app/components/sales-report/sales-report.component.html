<div class="container-fluid sales-report-container">
    <div class="row d-flex justify-content-center">
      <div class="col-sm-12 mt-4 pb-3">
        <h1 class="sales-report-title">Sales Guidance Report</h1>
      </div>
    </div>
    <div class="row d-flex justify-content-center">
      <div class="col-sm-12 mb-2 position-relative">
        <div class="row">
          <div class="col-sm-2 d-flex justify-content-start">
            <button
              (click)="toggleFilterVisibility()"
              mat-raised-button
              class="mt-3 p-3 filter-button"
            >  <mat-icon class="filter-icon">filter_list</mat-icon>
              Filter
            </button>
          </div>
          <div
            class="col-sm-2 position-absolute end-0 d-flex justify-content-end"
          >
            <button
              (click)="exportToExcel()"
              mat-raised-button
              class="excel-export-btn mt-3 p-3"
            >
            <mat-icon class="export-icon">cloud_download</mat-icon>
              Export to Excel
            </button>
          </div>
        </div>
      </div>
  
      <div class="col-sm-12 mb-5">
        <mat-tab-group
          class="mb-5 tab-container"
          (selectedTabChange)="selectedTab($event)"
        >
          <mat-tab label="Monthly">
            <div class="table-wrapper">
              <table mat-table [dataSource]="MonthlyDataSource">
                <ng-container
                  *ngFor="let column of displayedMonthlyCol; let i = index"
                  [matColumnDef]="column"
                  [sticky]="isSticky(column)"
                >
                  <th mat-header-cell *matHeaderCellDef>{{ column }}</th>
                  <span *ngIf="column == 'Account'">
                    <td
                      mat-cell
                      *matCellDef="let element"
                      [class.sticky-row]="i == 0 && column === 'Account'"
                    >
                      {{ element[column] | accountName }}
                    </td>
                  </span>
                  <span
                    *ngIf="column != 'Account' && column == 'Account Manager'"
                  >
                    <td
                      mat-cell
                      *matCellDef="let element"
                      [class.sticky-row]="i == 0 && column === 'Account Manager'"
                    >
                      {{ element[column] }}
                    </td>
                  </span>
                  <span
                    *ngIf="column != 'Account' && column != 'Account Manager'"
                  >
                    <td mat-cell *matCellDef="let element">
                      {{ element[column] | number }}
                    </td>
                  </span>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedMonthlyCol"></tr>
                <tr
                  mat-row
                  *matRowDef="let row; columns: displayedMonthlyCol"
                ></tr>
                <tr class="mat-row" *matNoDataRow>
                  <td class="mat-cell no-data-found" colspan="5">
                    No data Found !
                  </td>
                </tr>
              </table>
            </div>
            <div class="paginator">
              <mat-paginator
                #MonthlyPaginator
                fixed
                [pageSizeOptions]="[5, 10, 20, 50]"
                showFirstLastButtons
              >
              </mat-paginator>
            </div>
          </mat-tab>
  
          <mat-tab label="Quaterly">
            <div class="table-wrapper">
              <table mat-table [dataSource]="QuarterlyDataSource">
                <ng-container
                  *ngFor="let column of displayedQuarterlyCol; let i = index"
                  [matColumnDef]="column"
                  [sticky]="isSticky(column)"
                >
                  <th mat-header-cell *matHeaderCellDef>{{ column }}</th>
                  <span *ngIf="column == 'Account'">
                    <td
                      mat-cell
                      *matCellDef="let element"
                      [class.sticky-row]="i == 0 && column === 'Account'"
                    >
                      {{ element[column] | accountName }}
                    </td>
                  </span>
                  <span
                    *ngIf="column != 'Account' && column == 'Account Manager'"
                  >
                    <td
                      mat-cell
                      *matCellDef="let element"
                      [class.sticky-row]="i == 0 && column === 'Account Manager'"
                    >
                      {{ element[column] }}
                    </td>
                  </span>
                  <span
                    *ngIf="column != 'Account' && column != 'Account Manager'"
                  >
                    <td mat-cell *matCellDef="let element">
                      {{ element[column] | number }}
                    </td>
                  </span>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedQuarterlyCol"></tr>
                <tr
                  mat-row
                  *matRowDef="let row; columns: displayedQuarterlyCol"
                ></tr>
                <tr class="mat-row" *matNoDataRow>
                  <td class="mat-cell no-data-found" colspan="5">
                    No data Found !
                  </td>
                </tr>
              </table>
            </div>
            <div class="paginator">
              <mat-paginator
                #QuarterlyPaginator
                fixed
                [pageSizeOptions]="[5, 10, 20, 50]"
                showFirstLastButtons
              >
              </mat-paginator>
            </div>
          </mat-tab>
  
          <mat-tab label="HalfYearly">
            <div class="table-wrapper">
              <table mat-table [dataSource]="HalfYearlyDataSource">
                <ng-container
                  *ngFor="let column of displayedHalfYearlyCol; let i = index"
                  [matColumnDef]="column"
                  [sticky]="isSticky(column)"
                >
                  <th mat-header-cell *matHeaderCellDef>{{ column }}</th>
                  <span *ngIf="column == 'Account'">
                    <td
                      mat-cell
                      *matCellDef="let element"
                      [class.sticky-row]="i == 0 && column === 'Account'"
                    >
                      {{ element[column] | accountName }}
                    </td>
                  </span>
                  <span
                    *ngIf="column != 'Account' && column == 'Account Manager'"
                  >
                    <td
                      mat-cell
                      *matCellDef="let element"
                      [class.sticky-row]="i == 0 && column === 'Account Manager'"
                    >
                      {{ element[column] }}
                    </td>
                  </span>
                  <span
                    *ngIf="column != 'Account' && column != 'Account Manager'"
                  >
                    <td mat-cell *matCellDef="let element">
                      {{ element[column] | number }}
                    </td>
                  </span>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedHalfYearlyCol"></tr>
                <tr
                  mat-row
                  *matRowDef="let row; columns: displayedHalfYearlyCol"
                ></tr>
                <tr class="mat-row" *matNoDataRow>
                  <td class="mat-cell no-data-found" colspan="5">
                    No data Found !
                  </td>
                </tr>
              </table>
            </div>
            <div class="paginator">
              <mat-paginator
                #HalfYearlyPaginator
                fixed
                [pageSizeOptions]="[5, 10, 20, 50]"
                showFirstLastButtons
              >
              </mat-paginator>
            </div>
          </mat-tab>
  
          <mat-tab label="Yearly">
            <div class="table-wrapper">
              <table mat-table [dataSource]="YearlyDataSource">
                <ng-container
                  *ngFor="let column of displayedYearlyCol; let i = index"
                  [matColumnDef]="column"
                  [sticky]="isSticky(column)"
                >
                  <th mat-header-cell *matHeaderCellDef>{{ column }}</th>
                  <span *ngIf="column == 'Account'">
                    <td
                      mat-cell
                      *matCellDef="let element"
                      [class.sticky-row]="i == 0 && column === 'Account'"
                    >
                      {{ element[column] | accountName }}
                    </td>
                  </span>
                  <span
                    *ngIf="column != 'Account' && column == 'Account Manager'"
                  >
                    <td
                      mat-cell
                      *matCellDef="let element"
                      [class.sticky-row]="i == 0 && column === 'Account Manager'"
                    >
                      {{ element[column] }}
                    </td>
                  </span>
                  <span
                    *ngIf="column != 'Account' && column != 'Account Manager'"
                  >
                    <td mat-cell *matCellDef="let element">
                      {{ element[column] | number }}
                    </td>
                  </span>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedYearlyCol"></tr>
                <tr
                  mat-row
                  *matRowDef="let row; columns: displayedYearlyCol"
                ></tr>
                <tr class="mat-row" *matNoDataRow>
                  <td class="mat-cell no-data-found" colspan="5">
                    No data Found !
                  </td>
                </tr>
              </table>
            </div>
            <div class="paginator">
              <mat-paginator
                #YearlyPaginator
                fixed
                [pageSizeOptions]="[5, 10, 20, 50]"
                showFirstLastButtons
              >
              </mat-paginator>
            </div>
          </mat-tab>
        </mat-tab-group>
      </div>
    </div>
  </div>